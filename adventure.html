<button id="submitCommand">Submit</button>

<script>
  let office = {
    filingCabinetOpened: false,
    binOpened: false,
    fridgeOpened: false,
    hasMilk: false,
    windowOpened: false,
    hasCoffee: false,
    coffeeWithMilk: false,
    safeOpened: false
  };

  const openFilingCabinetCommands = ['open filing cabinet'];
  const openBinCommands = ['open bin'];
  const eatFishCommands = ['eat fish', 'consume fish'];
  const openFridgeCommands = ['open fridge'];
  const getMilkCommands = ['get milk', 'take milk', 'pick up milk'];
  const addMilkCommands = ['add milk to coffee', 'put milk in coffee', 'use milk'];
  const makeCoffeeCommands = ['make coffee', 'brew coffee'];
  const drinkCoffeeCommands = ['drink coffee', 'consume coffee'];
  const openSafeCommands = ['open safe'];
  const openWindowCommands = ['open window'];
  const leanOutWindowCommands = ['lean out window', 'look out window'];

  function resetGame(gameOverMessage) {
    office = {
      filingCabinetOpened: false,
      binOpened: false,
      fridgeOpened: false,
      hasMilk: false,
      windowOpened: false,
      hasCoffee: false,
      coffeeWithMilk: false,
      safeOpened: false
    };
    const outputElement = document.getElementById('gameOutput');
    outputElement.innerHTML = '';
    document.getElementById('submitCommand').textContent = 'Submit';
    printToOutput(gameOverMessage);
  }

  document.getElementById('submitCommand').addEventListener('click', function() {
    const command = document.getElementById('commandInput').value;
    document.getElementById('commandInput').value = '';

    if (this.textContent === 'Restart') {
      resetGame('You are in the NorthCoders office. There is a filing cabinet, a bin, a fridge, a window, a safe, a plug socket, a coffee machine, some blank sheets of paper, and computers. Vel is here, too.');
      this.textContent = 'Submit';
    } else {
      processCommand(command.toLowerCase());
    }
  });

  function processCommand(command) {
    if (openFilingCabinetCommands.includes(command)) {
      office.filingCabinetOpened = true;
      printToOutput('You open the filing cabinet. It is empty.');
    } else if (openBinCommands.includes(command)) {
      office.binOpened = true;
      printToOutput('You open the bin. There is a mouldy fish inside.');
    } else if (eatFishCommands.includes(command)) {
      if (office.binOpened) {
        resetGame('You eat the mouldy fish, immediately feel unwell, collapse on the floor and die. Don\'t eat things from a bin. That was a stupid thing to do!');
        document.getElementById('submitCommand').textContent = 'Restart';
      } else {
        printToOutput('What fish? Maybe you should look around.');
      }
    } else if (openFridgeCommands.includes(command)) {
      office.fridgeOpened = true;
      printToOutput('You open the fridge. There is a bottle of milk inside.');
    } else if (getMilkCommands.includes(command)) {
      if (office.fridgeOpened) {
        office.hasMilk = true;
        printToOutput('You take the milk from the fridge.');
      } else {
        printToOutput('What milk? Maybe you should look around.');
      }
    } else if (addMilkCommands.includes(command)) {
      if (office.hasMilk && office.hasCoffee) {
        office.coffeeWithMilk = true;
        printToOutput('You add milk to the coffee.');
      } else {
        printToOutput('You can\'t add milk to the coffee without having both the milk and coffee first.');
      }
    } else if (makeCoffeeCommands.includes(command)) {
      office.hasCoffee = true;
      printToOutput('You make a cup of black coffee.');
    } else if (drinkCoffeeCommands.includes(command)) {
      if (office.coffeeWithMilk) {
        printToOutput('You drink the coffee. It tastes wonderful.');
      } else if (office.hasCoffee) {
        printToOutput('You can\'t drink black coffee! Are you a psychopath?');
      } else {
        printToOutput('What coffee? Maybe you should look around.');
      }
    } else if (openSafeCommands.includes(command)) {
      office.safeOpened = true;
      printToOutput('You open the safe. It is empty.');
    } else if (openWindowCommands.includes(command)) {
      office.windowOpened = true;
      printToOutput('You open the window. You feel a cool breeze on your face. Maybe you should lean out the window?');
    } else if (leanOutWindowCommands.includes(command)) {
      if (office.windowOpened) {
        resetGame('You lean as far as you can out the window, lose your grip, fall to the ground and die. That was a stupid thing to do!');
        document.getElementById('submitCommand').textContent = 'Restart';
      } else {
        printToOutput('What window? Maybe you should look around.');
      }
    } else {
      printToOutput('I\'m not sure what you\'re trying to do. Please try another command.');
    }
  }

  function printToOutput(message) {
    const outputElement = document.getElementById('gameOutput');
    outputElement.innerHTML += message + '<br/><br/>';
    outputElement.scrollTop = outputElement.scrollHeight;
  }
</script>